<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{common/layout}">

<head>
    <meta charset="UTF-8">
    <title>プロフィール</title>
</head>

<body>
    <div layout:fragment="content" class="container mt-5" style="max-width: 400px;">
        <h2 class="text-center mb-4">プロフィール</h2>

        <!-- 成功メッセージ -->
        <div th:if="${success}" class="alert alert-success text-center" th:text="${success}"></div>

        <div class="border rounded p-4 shadow-sm bg-light">
            <!-- 名前 -->
            <div class="mb-3">
                <label class="form-label fw-semibold">名前</label>
                <div class="d-flex justify-content-between align-items-center">
                    <span th:text="${user.name}"></span>
                    <a th:href="@{/profile/edit-name}" th:unless="${isTestAdmin}" class="btn btn-success btn-sm">編集</a>
                    <a th:if="${isTestAdmin}" th:disabled="${isTestAdmin}"
                        class="btn btn-success btn-sm disabled">編集</a>
                </div>
                <p th:if="${isTestAdmin}" class="text-secondary small text-start mt-2">
                    テスト用管理者の名前は編集できません。
                </p>
                <hr class="my-1">
            </div>

            <!-- メールアドレス -->
            <div class="mb-3">
                <label class="form-label fw-semibold">メールアドレス</label>
                <div class="d-flex justify-content-between align-items-center">
                    <span th:text="${user.email}"></span>
                    <a th:href="@{/profile/edit-email}" th:unless="${isTestAdmin}" class="btn btn-success btn-sm">編集</a>
                    <a th:if="${isTestAdmin}" th:disabled="${isTestAdmin}"
                        class="btn btn-success btn-sm disabled">編集</a>
                </div>
                <p th:if="${isTestAdmin}" class="text-secondary small text-start mt-2">
                    テスト用管理者のメールアドレスは編集できません。
                </p>
                <hr class="my-1">
            </div>

            <!-- パスワード -->
            <div class="mb-3">
                <label class="form-label fw-semibold">パスワード</label>
                <div class="d-flex justify-content-between align-items-center">
                    <span>●●●●●●●●</span>
                    <a th:href="@{/profile/edit-password}" th:unless="${isTestAdmin}"
                        class="btn btn-success btn-sm">編集</a>
                    <a th:if="${isTestAdmin}" th:disabled="${isTestAdmin}"
                        class="btn btn-success btn-sm disabled">編集</a>
                </div>
                <p th:if="${isTestAdmin}" class="text-secondary small text-start mt-2">
                    テスト用管理者のパスワードは編集できません。
                </p>
                <hr class="my-1">
            </div>

            <!-- ログアウト -->
            <form th:action="@{/logout}" method="post" onsubmit="return confirm('本当にログアウトしますか？');" class="mt-4">
                <div class="d-grid">
                    <button type="submit" class="btn btn-outline-danger">ログアウト</button>
                </div>
            </form>

            <!-- アカウント削除 -->
            <form th:action="@{/profile/delete}" method="post"
                onsubmit="return confirm('本当にアカウントを削除しますか？この操作は取り消せません。');" class="mt-4">
                <div class="d-grid">
                    <button type="submit" th:disabled="${isTestAdmin}" class="btn btn-danger">アカウント削除</button>
                </div>
            </form>

            <div th:if="${error}" class="alert alert-danger text-center mt-3" th:text="${error}"></div>

            <p th:if="${isTestAdmin}" class="text-secondary small text-start mt-2">
                テスト用管理者のアカウントは削除できません。
            </p>
        </div>

        <!-- 戻るボタン -->
        <div class="text-center mt-4">
            <a th:href="@{/dashboard}" class="btn btn-outline-success">ダッシュボードに戻る</a>
        </div>
    </div>
</body>

</html>